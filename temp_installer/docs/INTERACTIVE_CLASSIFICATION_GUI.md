# Интерактивная классификация в GUI (v1.6.0)

## Обзор

Начиная с версии 1.6.0, BOM Categorizer имеет функцию **интерактивной классификации** нераспределенных элементов прямо в графическом интерфейсе.

## Зачем это нужно?

При обработке больших BOM-файлов некоторые компоненты могут не распознаться автоматически. Вместо ручного редактирования правил, вы можете:
1. Увидеть все нераспределенные элементы
2. Для каждого выбрать категорию в диалоговом окне
3. Автоматически сохранить правила для будущих обработок

## Как использовать?

### Шаг 1: Запустите интерактивную классификацию

1. Откройте `BOM Categorizer` (запустите `run_app.bat`)
2. Добавьте входные файлы (XLSX/DOCX/DOC/TXT)
3. Нажмите кнопку **"Интерактивная классификация"**

![Кнопка интерактивной классификации]

### Шаг 2: Дождитесь первичной обработки

Приложение автоматически:
- Обработает все входные файлы
- Определит нераспределенные элементы
- Покажет их количество

### Шаг 3: Классифицируйте элементы

Для каждого нераспределенного элемента откроется диалоговое окно:

```
╔═══════════════════════════════════════════════════════════════╗
║         Элемент 1 из 5                                        ║
╠═══════════════════════════════════════════════════════════════╣
║                                                               ║
║  Наименование: электропитания МДМ50-1 $БКЯЮ436630001ТУ$      ║
║                                                               ║
║  Количество: 4     Источник: All_IBP.xlsx Лист_3             ║
║                                                               ║
╠═══════════════════════════════════════════════════════════════╣
║  Выберите категорию (или нажмите 0-11 на клавиатуре):       ║
║                                                               ║
║  1. Отладочные модули       7. Разъемы                       ║
║  2. Микросхемы              8. Оптические компоненты          ║
║  3. Резисторы               9. Модули питания                 ║
║  4. Конденсаторы           10. Кабели                         ║
║  5. Индуктивности          11. Другие                         ║
║  6. Полупроводники          0. Пропустить                     ║
║                                                               ║
╚═══════════════════════════════════════════════════════════════╝
```

**Выберите категорию:**
- Нажмите кнопку нужной категории **ИЛИ**
- Нажмите цифру на клавиатуре (0-11)

### Шаг 4: Автоматическое сохранение

После классификации всех элементов:
1. Правила автоматически сохраняются в `rules.json`
2. Запускается повторная обработка с новыми правилами
3. Результат записывается в выходной файл

## Пример использования

**Сценарий:** Обработка All_IBP.xlsx с 6 листами

### До интерактивной классификации:
```
Не распределено: 43 элемента
  - электропитания МДМ50-1
  - электропитания МДМ20-1
  - Плата инструментальная AES-ZU-IOCC-G
  - Реле РЭК93В
  - ...
```

### После улучшений в v1.6.0:
- ✅ Автоматически добавлены ключевые слова: "электропитания", "МДМ", "МАА", "реле", "фильтр"
- ✅ Не распределено: **7 элементов**

### Интерактивная классификация оставшихся 7:
1. **ПЛАТА 117212-HMC624ALP4** → Выбираете "1. Отладочные модули"
2. **Прибор ФВК3-28** → Выбираете "8. Оптические компоненты"
3. **Прибор ФКВН3-6** → Выбираете "8. Оптические компоненты"
4. И т.д...

### Результат:
```
✅ Сохранено 5 новых правил классификации в rules.json
✅ Не распределено: 0 элементов
```

## Клавиатурные сокращения

Для быстрой работы используйте цифры:
- `1` - Отладочные модули
- `2` - Микросхемы
- `3` - Резисторы
- `4` - Конденсаторы
- `5` - Индуктивности
- `6` - Полупроводники
- `7` - Разъемы
- `8` - Оптические компоненты
- `9` - Модули питания
- `10` (цифры `1` затем `0`) - Кабели
- `11` (цифры `1` затем `1`) - Другие
- `0` - Пропустить элемент

## Файл rules.json

Правила сохраняются в формате:

```json
[
  {
    "contains": "плата",
    "category": "dev_boards",
    "comment": "Добавлено пользователем для 'ПЛАТА 117212-HMC624ALP4 HITTITE'"
  },
  {
    "contains": "прибор",
    "category": "optics",
    "comment": "Добавлено пользователем для 'Прибор ФВК3-28'"
  }
]
```

### Как работают правила?

- **contains**: Ключевое слово (первое слово из наименования элемента)
- **category**: Внутреннее имя категории
- **comment**: Пояснение, когда и для чего добавлено правило

При следующей обработке **любого** BOM-файла, если в наименовании встретится это ключевое слово, элемент автоматически попадет в указанную категорию!

## Преимущества

1. **Быстро**: Не нужно редактировать код или JSON вручную
2. **Интуитивно**: Видите полную информацию о каждом элементе
3. **Накопительно**: Правила сохраняются и применяются ко всем будущим обработкам
4. **Гибко**: Можно пропустить элементы, классифицировать позже

## Улучшения классификации в v1.6.0

Автоматически добавлены ключевые слова для:
- **Модули питания**: электропитания, МДМ10/20/30/50/60/100/160/600, МАА20/400/600
- **Отладочные платы**: плата инструментальная, AES-ZU
- **Другие**: реле, тумблер, фильтр, сетка защитная, коммутатор, переход, линия задержки, сердечник, кварц, вставка плавкая

Благодаря этому количество нераспределенных элементов сократилось с **43 до 7** для All_IBP.xlsx!

## Советы

1. **Обрабатывайте типовые файлы first**: После первой интерактивной классификации типового BOM, последующие файлы будут обрабатываться с минимальным количеством нераспределенных элементов.

2. **Используйте "Пропустить"**: Если не уверены в категории, пропустите элемент. Вы сможете классифицировать его позже.

3. **Проверяйте results**: После интерактивной классификации откройте выходной XLSX и убедитесь, что элементы попали в правильные категории.

4. **Редактируйте rules.json**: Можете вручную добавлять/удалять правила в файле `rules.json` при необходимости.

---

**Версия**: 1.6.0  
**Дата**: 07.10.2025

