# Исправлена проблема с категоризацией BOM файлов

## Что было исправлено:

### ❌ Проблема:
Компоненты неправильно сортировались по категориям. Многие элементы попадали в "Не распределено".

### ✅ Решение:
Исправлена функция классификации в файле `split_bom.py`:

1. **Добавлена поддержка русских обозначений компонентов:**
   - `А1`, `А2` → Оптические компоненты (аттенюаторы)
   - `W1`, `W2` → СВЧ модули (усилители, линии задержек)
   - `WS1-WS3` → СВЧ делители
   - `WU1-WU4` → СВЧ аттенюаторы
   - `H1`, `H2` → Индикаторы/светодиоды
   - `S4` → Тумблеры/переключатели

2. **Расширены ключевые слова для распознавания:**
   - **Оптика**: "аттенюат", "fc/apc", "fc/upc", "pigtail"
   - **СВЧ**: "линия задержек", "делитель", "усилитель", "polaris", "mini-circuits"
   - **Переключатели**: "тумблер", "кнопка", "переключ"

## Результаты на примере БЗ.doc:

| Категория | До | После | Улучшение |
|-----------|-----|-------|-----------|
| Оптические компоненты | 8 | **10** | ✅ +2 |
| СВЧ модули | 11 | **18** | ✅ +7 |
| Другие (тумблеры) | 2 | **3** | ✅ +1 |
| **Не распределено** | **67** | **57** | ✅ **-10** |

## Как использовать:

### Через GUI (app.py):
```bash
.venv\Scripts\python.exe app.py
```
1. Добавьте файлы (XLSX/DOC/DOCX/TXT)
2. Укажите выходной файл
3. Нажмите "Запустить"

### Через командную строку:
```bash
.venv\Scripts\python.exe split_bom.py --inputs "example/БЗ.doc" --xlsx categorized.xlsx --combine
```

## Категории компонентов:

✅ **Работают правильно:**
- Резисторы (R)
- Конденсаторы (C)
- Дроссели (L)
- Микросхемы (U, DD, DA, IC)
- Разъемы (J, X, P, K)
- **Оптика (А, ключевые слова)**
- **СВЧ модули (W, WS, WU, ключевые слова)**
- **Индикаторы (H)**
- **Тумблеры (S + ключевые слова)**
- Отладочные платы
- Кабели
- Модули питания
- Наши разработки
- Другие компоненты

## Примечания:

- Элементы в категории "Не распределено" (57 шт) в основном пустые строки или элементы без описания
- Для дополнительной настройки категоризации используйте файл `rules.json`
- Интерактивный режим доступен через командную строку: `--interactive`

---
**Автор исправлений:** AI Assistant  
**Дата:** 03.10.2025  
**Версия:** 1.0.4+fix

