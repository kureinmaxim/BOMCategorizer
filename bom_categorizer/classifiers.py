# -*- coding: utf-8 -*-
"""
–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: classify_row()
–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞:
- –†–µ—Ñ–µ—Ä–µ–Ω—Å–Ω—ã—Ö –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è—Ö (R, C, L, U –∏ —Ç.–¥.)
- –ö–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤–∞—Ö –≤ –æ–ø–∏—Å–∞–Ω–∏–∏
- –ù–æ–º–∏–Ω–∞–ª–∞—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è—Ö –∏ —Ç–∏–ø–∞—Ö
"""

import re
from typing import Any, Optional

from .utils import has_any, RESISTOR_VALUE_RE, CAP_VALUE_RE, IND_VALUE_RE
from .component_database import get_component_category


def classify_row(
    ref: Optional[str], 
    description: Optional[str], 
    value: Optional[str], 
    partname: Optional[str], 
    strict: bool, 
    source_file: Optional[str] = None, 
    note: Optional[str] = None,
    group_type: Optional[str] = None
) -> str:
    """
    –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    
    Args:
        ref: –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ (reference designator)
        description: –û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
        value: –ù–æ–º–∏–Ω–∞–ª –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
        partname: –ù–æ–º–µ—Ä –¥–µ—Ç–∞–ª–∏/–∞—Ä—Ç–∏–∫—É–ª
        strict: –°—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
        source_file: –ò–º—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
        note: –ü—Ä–∏–º–µ—á–∞–Ω–∏—è (–¢–£, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å)
        group_type: –¢–∏–ø –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏–∑ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞
        
    Returns:
        –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–∫–ª—é—á)
    """
    def to_text(x: Any) -> str:
        if x is None:
            return ""
        try:
            import math
            if isinstance(x, float) and math.isnan(x):
                return ""
        except Exception:
            pass
        s = str(x)
        return s.strip()

    ref = to_text(ref)
    desc = to_text(description)
    val = to_text(value)
    part = to_text(partname)
    src_file = to_text(source_file)
    note_text = to_text(note)
    group_type_text = to_text(group_type)  # –¢–∏–ø –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –≥—Ä—É–ø–ø—ã (DOCX)

    # Create text blob early for use in reference-based checks (—Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞—è note –∏ group_type!)
    # –í–ê–ñ–ù–û: group_type –ø–æ–º–æ–≥–∞–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ß–∏–ø –∫–∞—Ç—É—à–∫–∏ –∏–Ω–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏")
    text_blob = " ".join([desc, val, part, note_text, group_type_text])
    text_blob_lower = text_blob.lower()

    # Refdes first where reliable
    ref_prefix = ref.split(" ")[0].upper() if ref else ""
    ref_prefix = re.sub(r"\d.*$", "", ref_prefix)  # take letters before digits

    # ===================================================================
    # –°–ê–ú–´–ô –í–´–°–®–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢: –°–ª—É–∂–µ–±–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (–ù–ï –ò–í–ü)
    # –û—à–∏–±–æ—á–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Ç–µ–∫—Å—Ç –∏–∑ —Ä–∞–º–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –ø–æ–¥–ø–∏—Å–∏, —à—Ç–∞–º–ø—ã –∏ —Ç.–¥.
    # –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï: –ó–∞–º–µ–Ω—ã –∏ –ø–æ–¥–±–æ—Ä—ã (—É –Ω–∏—Ö –Ω–µ—Ç ref, –Ω–æ –æ–Ω–∏ - —Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã!)
    # ===================================================================
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –∑–∞–º–µ–Ω–æ–π –∏–ª–∏ –ø–æ–¥–±–æ—Ä–æ–º (–ø–æ source_file)
    is_replacement_or_podbor = False
    if src_file:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∫ –ø–æ–ª–Ω—ã–µ, —Ç–∞–∫ –∏ —Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
        is_replacement_or_podbor = (
            '(–∑–∞–º–µ–Ω–∞)' in src_file or '(–ø–æ–¥–±–æ—Ä)' in src_file or
            '(–∑–∞–º ' in src_file or '(–ø/–± ' in src_file
        )
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –∏ –Ω–∞–ª–∏—á–∏–µ —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å–ª–æ–≤
    # –ù–û –ù–ï –¥–ª—è –∑–∞–º–µ–Ω –∏ –ø–æ–¥–±–æ—Ä–æ–≤!
    if not is_replacement_or_podbor and (not ref or not ref.strip()):
        # –°–ª—É–∂–µ–±–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ä–∞–º–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
        service_patterns = [
            '–∏–∑–º.', '–∏–∑–º–µ–Ω–µ–Ω', '–∑–∞–º–µ–Ω–µ–Ω', '–∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω',
            '–ª–∏—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏', '—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π',
            '–≤—Å–µ–≥–æ –ª–∏—Å—Ç–æ–≤', '–Ω–æ–º–µ—Ä –¥–æ–∫—É–º', '–ø–æ–¥–ø–∏—Å—å', '–ø–æ–¥–ø.',
            '–≤—Ö–æ–¥—è—â–∏–π', '—Å–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ–ª—å', '–∫–æ–ø–∏—Ä–æ–≤–∞–ª', '—Ñ–æ—Ä–º–∞—Ç',
            '–¥–∞—Ç–∞', '–ø—Ä–æ–≤–µ—Ä–∏–ª', '—É—Ç–≤–µ—Ä–¥–∏–ª', '–Ω. –∫–æ–Ω—Ç—Ä', '—Ä–∞–∑—Ä–∞–±.',
            '–ª–∏—Ç.', '–º–∞—Å—Å–∞', '–º–∞—Å—à—Ç–∞–±', '–ª–∏—Å—Ç', '–¥–æ–∫—É–º.', '–¥–æ–∫—É–º–µ–Ω—Ç',
            '–ø–µ—Ä–≤. –ø—Ä–∏–º–µ–Ω', '—Å–ø—Ä–∞–≤.', '—Å–ø—Ä–∞–≤–æ—á–Ω', '—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è',
            '–ø–µ—Ä–µ—á–µ–Ω—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤', '–≤–µ–¥–æ–º–æ—Å—Ç—å', '—à—Ç–∞–º–ø',
            '–¥–µ–∫–∞–¥–∞', '–≥–æ–¥', '–º–µ—Å—è—Ü',
            '–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', '–¥–ª—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–π'  # –î–æ–±–∞–≤–ª–µ–Ω–æ
        ]
        
        if any(pattern in text_blob_lower for pattern in service_patterns):
            return "non_bom"
    
        # –û—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Ç—Ä–æ–∫–∏ –±–µ–∑ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è - —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –º—É—Å–æ—Ä
        # –ù–û –ù–ï –¥–ª—è –∑–∞–º–µ–Ω –∏ –ø–æ–¥–±–æ—Ä–æ–≤!
        if len(text_blob.strip()) < 10:
            return "non_bom"
    
        # –°—Ç—Ä–æ–∫–∏, —Å–æ—Å—Ç–æ—è—â–∏–µ —Ç–æ–ª—å–∫–æ –∏–∑ —á–∏—Å–µ–ª –∏–ª–∏ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤
        if text_blob.strip() and re.fullmatch(r'[\d\s\-\.,:;/\\]+', text_blob.strip()):
            return "non_bom"

    # ===================================================================
    # –°–ê–ú–´–ô –í–´–°–®–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    # ===================================================================
    if desc:
        db_category = get_component_category(desc)
        if db_category:
            # print(f"   üéØ –ù–∞–π–¥–µ–Ω–æ –≤ –±–∞–∑–µ: {desc} ‚Üí {db_category}")  # –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            return db_category
    
    # –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º partname
    if part:
        db_category = get_component_category(part)
        if db_category:
            # print(f"   üéØ –ù–∞–π–¥–µ–Ω–æ –≤ –±–∞–∑–µ: {part} ‚Üí {db_category}")  # –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            return db_category

    # ===================================================================
    # –ù–ê–ò–í–´–°–®–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢: –ù–ê–®–ò –†–ê–ó–†–ê–ë–û–¢–ö–ò
    # –õ—é–±–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å –Ω–æ–º–µ—Ä–∞–º–∏ 195-, –ê–ú–§–ò, –ì–í–ê–¢ - —ç—Ç–æ –Ω–∞—à–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
    # –≠—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–ª–∞—Ç—ã, –±–ª–æ–∫–∏, –º–æ–¥—É–ª–∏, –≤–µ–Ω—Ç–∏–ª–∏ –°–í–ß –∏ —Ç.–¥.
    # –í–ê–ñ–ù–û: –ü—Ä–æ–≤–µ—Ä—è–µ–º –î–û —Ç–∏–ø–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (—Ä–µ–∑–∏—Å—Ç–æ—Ä—ã —Å –ê–ú–§–ò - —ç—Ç–æ –ø–æ–∫—É–ø–Ω—ã–µ!)
    # ===================================================================
    
    # –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ï—Å–ª–∏ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ù–ê–ß–ò–ù–ê–ï–¢–°–Ø —Å "–ì–í–ê–¢" –∏–ª–∏ "–ì–í–ê–¢." - —ç—Ç–æ –í–°–ï–ì–î–ê –Ω–∞—à–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!
    # –ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–∏–ø–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (–¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ —Ä–µ–∑–∏—Å—Ç–æ—Ä, –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä –∏ —Ç.–¥.)
    # –≠—Ç–æ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º, –ø–æ–¥–±–æ—Ä–Ω—ã–º –∏ –∑–∞–º–µ–Ω—è–µ–º—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º
    desc_upper = to_text(description).upper().strip()
    if desc_upper.startswith("–ì–í–ê–¢") or desc_upper.startswith("–ì–í–ê–¢."):
        return "our_developments"
    
    if has_any(text_blob, [
        "195-9530", "195-", "–∞–º—Ñ–∏.", "–∞–º—Ñ–∏ ", "–≥–≤–∞—Ç.", "–≥–≤–∞—Ç ",
        "—à—Å–∫-–º", "–ø–ª–∞—Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ —à—Å–∫", "–ø–ª–∞—Ç–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—è —É—Ä–æ–≤–Ω–µ–π",
        "–±–∑ —à—Å–∫-–º", "–±—Ñ —à—Å–∫-–º", "–Ω–∞—à–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç", "—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç"
    ]):
        # –ò—Å–∫–ª—é—á–∞–µ–º –¢–û–õ–¨–ö–û —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≠–†–ò (—Ä–µ–∑–∏—Å—Ç–æ—Ä—ã, –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä—ã —Å –∫–æ–¥–æ–º –ê–ú–§–ò - —ç—Ç–æ –ø–æ–∫—É–ø–Ω—ã–µ)
        # –í–°–ï –æ—Å—Ç–∞–ª—å–Ω–æ–µ —Å –ê–ú–§–ò, 195- ‚Üí –Ω–∞—à–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–≤–∫–ª—é—á–∞—è –≤–µ–Ω—Ç–∏–ª–∏ –°–í–ß!)
        # –ì–í–ê–¢ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω –≤—ã—à–µ - –≤—Å–µ–≥–¥–∞ –∏–¥—ë—Ç –≤ –Ω–∞—à–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
        standard_components = ["—Ä–µ–∑–∏—Å—Ç–æ—Ä", "–∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä", "–¥—Ä–æ—Å—Å–µ–ª—å", "–∏–Ω–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç", "–º–∏–∫—Ä–æ–¥—Ä–æ—Å—Å–µ–ª—å"]
        is_standard_component = any(comp in text_blob_lower for comp in standard_components)
        
        if not is_standard_component:
            return "our_developments"
    
    # ===================================================================
    # –ù–ê–ò–í–´–°–®–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢: –Ø–≤–Ω—ã–µ —Ç–∏–ø—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–í–ê–ñ–ù–ï–ï –∫–æ–¥–∞ –ê–ú–§–ò!)
    # –ï—Å–ª–∏ —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω —Ç–∏–ø (—Ä–µ–∑–∏—Å—Ç–æ—Ä, –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä, –º–∏–∫—Ä–æ–¥—Ä–æ—Å—Å–µ–ª—å –∏ —Ç.–¥.),
    # —Ç–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –ø–æ —Ç–∏–ø—É, –î–ê–ñ–ï –µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–¥ –ê–ú–§–ò
    # ===================================================================
    
    # –ú–∏–∫—Ä–æ–¥—Ä–æ—Å—Å–µ–ª—å/–î—Ä–æ—Å—Å–µ–ª—å - –≤ –∏–Ω–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–¥–∞–∂–µ —Å –∫–æ–¥–æ–º –ê–ú–§–ò)
    if has_any(text_blob, ["–º–∏–∫—Ä–æ–¥—Ä–æ—Å—Å–µ–ª—å", "–¥—Ä–æ—Å—Å–µ–ª—å", "–∏–Ω–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", "—Å–µ—Ä–¥–µ—á–Ω–∏–∫"]):
        return "inductors"
    
    # –†–µ–∑–∏—Å—Ç–æ—Ä - –≤ —Ä–µ–∑–∏—Å—Ç–æ—Ä—ã (–¥–∞–∂–µ —Å –∫–æ–¥–æ–º –ê–ú–§–ò)
    if has_any(text_blob, ["—Ä–µ–∑–∏—Å—Ç–æ—Ä ", " —Ä–µ–∑–∏—Å—Ç–æ—Ä"]):
        return "resistors"
    
    # –ö–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä - –≤ –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä—ã (–¥–∞–∂–µ —Å –∫–æ–¥–æ–º –ê–ú–§–ò)
    if has_any(text_blob, ["–∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä ", " –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä"]):
        return "capacitors"
    
    # –ü—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å - –≤ –¥—Ä—É–≥–∏–µ (–¥–∞–∂–µ —Å –∫–æ–¥–æ–º –ê–ú–§–ò)
    if has_any(text_blob, ["–ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å", "fuse", "fuzetec"]):
        return "others"
    
    # ===================================================================
    # –í–´–°–®–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢: –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ —Ç–∏–ø–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –≤ –æ–ø–∏—Å–∞–Ω–∏–∏
    # –ï—Å–ª–∏ –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ –µ—Å—Ç—å —è–≤–Ω—ã–µ —Å–ª–æ–≤–∞-–º–∞—Ä–∫–µ—Ä—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ - —ç—Ç–æ –≥–ª–∞–≤–Ω–æ–µ!
    # ===================================================================
    
    # –†–µ–∑–∏—Å—Ç–æ—Ä—ã (–ù–û –ù–ï —Å –∫–æ–¥–æ–º –ì–í–ê–¢ - —ç—Ç–æ –Ω–∞—à–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!)
    if has_any(text_blob, ["—Ä–µ–∑–∏—Å—Ç–æ—Ä", "resistor", "—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω"]):
        # –ò—Å–∫–ª—é—á–∞–µ–º –ì–í–ê–¢ - —ç—Ç–æ –Ω–∞—à–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!
        if not has_any(text_blob, ["–≥–≤–∞—Ç.", "–≥–≤–∞—Ç "]):
            return "resistors"
    
    # –ö–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä—ã (–Ω–æ –ù–ï –¥–µ–ª–∏—Ç–µ–ª–∏ –º–æ—â–Ω–æ—Å—Ç–∏!)
    if has_any(text_blob, ["–∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä", "capacitor"]):
        # –ò—Å–∫–ª—é—á–∞–µ–º –¥–µ–ª–∏—Ç–µ–ª–∏ –º–æ—â–Ω–æ—Å—Ç–∏ - –æ–Ω–∏ –∏–¥—É—Ç –≤ dev_boards
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å –æ–¥–Ω–∏–º –∏ –¥–≤—É–º—è –ø—Ä–æ–±–µ–ª–∞–º–∏ (–≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–≥—É—Ç –±—ã—Ç—å –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã)
        if not has_any(text_blob, ["–¥–µ–ª–∏—Ç–µ–ª—å –º–æ—â–Ω–æ—Å—Ç–∏", "–¥–µ–ª–∏—Ç–µ–ª—å  –º–æ—â–Ω–æ—Å—Ç–∏", "power divider"]):
            return "capacitors"
    
    # –ú–∏–∫—Ä–æ—Å—Ö–µ–º—ã (–Ω–æ –ù–ï –æ–ø—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏ –∏ –º–æ–¥—É–ª–∏ —Å–≤—è–∑–∏ —Å "ic" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è!)
    # –í–ê–ñ–ù–û: –ê—Ç—Ç–µ–Ω—é–∞—Ç–æ—Ä—ã —Ç–µ–ø–µ—Ä—å –ù–ï –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –º–∏–∫—Ä–æ—Å—Ö–µ–º—ã - –æ–Ω–∏ –∏–¥—É—Ç –≤ –°–í–ß –º–æ–¥—É–ª–∏!
    if has_any(text_blob, ["–º–∏–∫—Ä–æ—Å—Ö–µ–º", "–∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞"]):
        return "ics"
    # –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏ –º–∏–∫—Ä–æ—Å—Ö–µ–º: Analog Devices (HMC), Mini-Circuits (–†–ê–¢, PE)
    # –í–ê–ñ–ù–û: "pat - " —Å –ø—Ä–æ–±–µ–ª–æ–º –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–∏–ø–∞ "PAT - 15+"
    if has_any(text_blob, ["hmc", "—Ä–∞—Ç-", "pat-", "pat - ", "—Ä–∞—Ç - ", "pe43", "pe44"]):
        return "ics"
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º "ic" —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ù–ï–¢ –æ–ø—Ç–∏—á–µ—Å–∫–∏—Ö –º–∞—Ä–∫–µ—Ä–æ–≤ –∏–ª–∏ –º–æ–¥—É–ª–µ–π —Å–≤—è–∑–∏
    if has_any(text_blob, ["ic ", " ic", "chip ", " chip"]):
        if not has_any(text_blob, ["–æ–ø—Ç–∏—á", "optical", "photonic", "–ø–µ—Ä–µ–¥–∞—é—â–∏–π", "–ø—Ä–∏–µ–º–Ω—ã–π", "electronic", 
                                    "quantic", "ebyte", "nt1"]):
            return "ics"
    
    # –î—Ä–æ—Å—Å–µ–ª–∏/–ò–Ω–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    if has_any(text_blob, ["–¥—Ä–æ—Å—Å–µ–ª—å", "–º–∏–∫—Ä–æ–¥—Ä–æ—Å—Å–µ–ª—å", "inductor", "–∫–∞—Ç—É—à–∫–∞ –∏–Ω–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏", "–∏–Ω–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", "—Å–µ—Ä–¥–µ—á–Ω–∏–∫", "core", "–∫–∞—Ç—É—à–∫–∏ –∏–Ω–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"]):
        return "inductors"
    
    # –ü–æ–ª—É–ø—Ä–æ–≤–æ–¥–Ω–∏–∫–∏ (–¥–∏–æ–¥—ã, —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä—ã, —Å—Ç–∞–±–∏–ª–∏—Ç—Ä–æ–Ω—ã, –æ–ø—Ç—Ä–æ–Ω—ã)
    if has_any(text_blob, ["–¥–∏–æ–¥ ", " –¥–∏–æ–¥", "diode", "—Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä", "transistor", "—Å—Ç–∞–±–∏–ª–∏—Ç—Ä–æ–Ω", "–æ–ø—Ç—Ä–æ–Ω", "optocoupler"]):
        return "semiconductors"
    
    # –†–∞–∑—ä–µ–º—ã
    if has_any(text_blob, ["—Ä–∞–∑—ä–µ–º", "connector", "–≤–∏–ª–∫–∞ ", "—Ä–æ–∑–µ—Ç–∫–∞ ", "socket", "plug", "–ø–µ—Ä–µ—Ö–æ–¥ "]):
        return "connectors"
    
    # ===================================================================
    # –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –û–ø—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º –ü–ï–†–ï–î –∫–∞–±–µ–ª—è–º–∏!
    # –õ—é–±–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ —Å–ª–æ–≤–æ–º "–æ–ø—Ç–∏—á–µ—Å–∫" –¥–æ–ª–∂–µ–Ω –ø–æ–ø–∞—Å—Ç—å –≤ optics
    # ===================================================================
    
    # –û–ø—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    if has_any(text_blob, [
        "–æ–ø—Ç–∏—á–µ—Å–∫–∏–π –º–æ–¥—É–ª—å", "optical module", "–ø–µ—Ä–µ–¥–∞—é—â–∏–π –æ–ø—Ç–∏—á–µ—Å–∫–∏–π", "–ø—Ä–∏–µ–º–Ω—ã–π –æ–ø—Ç–∏—á–µ—Å–∫–∏–π",
        "–æ–ø—Ç–∏—á–µ—Å–∫–∏–π –∞—Ç—Ç–µ–Ω—é–∞—Ç–æ—Ä", "–∞—Ç—Ç–µ–Ω—é–∞—Ç–æ—Ä –æ–ø—Ç–∏—á–µ—Å–∫–∏–π", "optical attenuator",
        "mp2320", "mp2220", "fc/apc", "fc/upc", "—Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –æ–ø—Ç–∏—á–µ—Å–∫–∏–π",
        "–æ–ø—Ç–æ–≤–æ–ª–æ–∫–æ–Ω", "fiber optic", "–º–≤–æ–ª", "–º–≤–æ–∫", "–ª–∏–Ω–∏—è –º–Ω–æ–≥–æ–∫–∞–Ω–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∏",
        "–∫–æ–º–º—É—Ç–∞—Ç–æ—Ä –æ–ø—Ç–∏—á–µ—Å–∫–∏–π", "–æ–ø—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä", "optical switch",
        "–∫–∞–±–µ–ª—å –æ–ø—Ç–∏—á–µ—Å–∫–∏–π", "–æ–ø—Ç–∏—á–µ—Å–∫–∏–π –∫–∞–±–µ–ª—å", "optical cable"
    ]):
        return "optics"
    
    # –õ—é–±–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å "–æ–ø—Ç–∏—á–µ—Å–∫" –≤ –Ω–∞—á–∞–ª–µ/–∫–æ–Ω—Ü–µ —Å–ª–æ–≤–∞ -> optics
    # (–æ–ø—Ç–∏—á–µ—Å–∫–∏–π, –æ–ø—Ç–∏—á–µ—Å–∫–∞—è, –æ–ø—Ç–∏—á–µ—Å–∫–æ–µ, –æ–ø—Ç–∏—á–µ—Å–∫–∏–µ)
    if "–æ–ø—Ç–∏—á–µ—Å–∫" in text_blob or "optical" in text_blob:
        return "optics"
    
    # –ö–∞–±–µ–ª–∏ (–ù–ï –æ–ø—Ç–∏—á–µ—Å–∫–∏–µ - –æ–Ω–∏ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –≤—ã—à–µ!)
    if has_any(text_blob, ["–∫–∞–±–µ–ª—å", "cable", "–ø—Ä–æ–≤–æ–¥", "wire", "–ø–∞—Ç—á-–∫–æ—Ä–¥", "–ø–∞—Ç—á –∫–æ—Ä–¥", "–∫–∞–±–µ–ª—å–Ω", "—Å–±–æ—Ä–∫–∞ –∫–∞–±–µ–ª—å–Ω–∞—è", "—à–ª–µ–π—Ñ"]):
        return "cables"
    
    # –ú–æ–¥—É–ª–∏ –ø–∏—Ç–∞–Ω–∏—è
    if has_any(text_blob, ["–º–æ–¥—É–ª—å –ø–∏—Ç–∞–Ω–∏—è", "–º–æ–¥—É–ª—å —ç–ª–µ–∫—Ç—Ä–æ–ø–∏—Ç–∞–Ω–∏—è", "—ç–ª–µ–∫—Ç—Ä–æ–ø–∏—Ç–∞–Ω–∏—è –º–æ–¥—É–ª—å", "power module", "–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—Ç–∞–Ω–∏—è", "dc/dc", "dc-dc"]):
        return "power_modules"

    # PRIORITY 1: Check context-specific categories FIRST (before generic prefixes)
    # Check if this is a board/PCB file (self-reference: description is just the filename)
    if src_file and desc:
        file_base = src_file.split('/')[-1].split('\\')[-1].rsplit('.', 1)[0].lower()
        desc_lower = desc.lower()
        
        component_keywords = ['—Ä–µ–∑–∏—Å—Ç–æ—Ä', '–∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä', '–º–∏–∫—Ä–æ—Å—Ö–µ–º–∞', '—Ä–∞–∑—ä–µ–º', '–¥–∏–æ–¥', '–∏–Ω–¥—É–∫—Ç–æ—Ä', '–¥—Ä–æ—Å—Å–µ–ª—å',
                             '—Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä', '—Å—Ç–∞–±–∏–ª–∏—Ç—Ä–æ–Ω', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '–≤–∏–ª–∫–∞', '—Ä–æ–∑–µ—Ç–∫–∞', '–∫–∞–±–µ–ª—å']
        is_component = any(kw in desc_lower for kw in component_keywords)
        
        if not is_component and file_base in desc_lower.replace('.xlsx', '').replace('.xls', ''):
            desc_clean = desc_lower.replace('.xlsx', '').replace('.xls', '').replace(' ', '').replace('_', '')
            file_clean = file_base.replace(' ', '').replace('_', '')
            if desc_clean == file_clean or desc_clean.startswith(file_clean) or file_clean in desc_clean:
                return "our_developments"
    
    # –í–ê–ñ–ù–û: –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ü–ï–†–ï–î —à–∏—Ä–æ–∫–∏–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
    # –ê–¥–∞–ø—Ç–µ—Ä—ã –≤ —Ä–∞–∑—ä–µ–º—ã
    if has_any(text_blob, ["–∞–¥–∞–ø—Ç–µ—Ä", "adapter"]):
        if not has_any(text_blob, ["fc/", "sc/", "lc/", "–æ–ø—Ç–∏—á–µ—Å–∫", "optical", "fiber"]):
            return "connectors"
    
    # –°–í–ß –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–∞—Ç—Ç–µ–Ω—é–∞—Ç–æ—Ä—ã, –¥–µ–ª–∏—Ç–µ–ª–∏, –æ—Ç–≤–µ—Ç–≤–∏—Ç–µ–ª–∏)
    # –í–ê–ñ–ù–û: –í–°–ï –∞—Ç—Ç–µ–Ω—é–∞—Ç–æ—Ä—ã (–Ω–µ –æ–ø—Ç–∏—á–µ—Å–∫–∏–µ) –ø–æ–ø–∞–¥–∞—é—Ç –≤ –°–í–ß –º–æ–¥—É–ª–∏!
    if has_any(text_blob, ["–∞—Ç—Ç–µ–Ω—é–∞—Ç–æ—Ä", "attenuator"]):
        # –í–ê–ñ–ù–û: –¢–æ–ª—å–∫–æ –ù–ï-–æ–ø—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã!
        if not has_any(text_blob, ["–æ–ø—Ç–∏—á", "optical", "fc/apc", "fc/upc", "fiber"]):
            return "rf_modules"
    
    # –î—Ä—É–≥–∏–µ –°–í–ß –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π
    if has_any(text_blob, ["–¥–µ–ª–∏—Ç–µ–ª—å –º–æ—â–Ω–æ—Å—Ç–∏", "–¥–µ–ª–∏—Ç–µ–ª—å  –º–æ—â–Ω–æ—Å—Ç–∏", "power divider", 
                           "–æ—Ç–≤–µ—Ç–≤–∏—Ç–µ–ª—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π", "–æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å", "–ª–∏–Ω–∏—è –∑–∞–¥–µ—Ä–∂–µ–∫"]):
        # –í–ê–ñ–ù–û: –¢–æ–ª—å–∫–æ –ù–ï-–æ–ø—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã!
        if not has_any(text_blob, ["–æ–ø—Ç–∏—á", "optical", "fc/apc", "fc/upc", "fiber"]):
            if has_any(text_blob, ["qualwave", "mini-circuits", "api technologies", "weinschel", "a-info", "gigabaudics", 
                                   "quantic pmi", "quantic", "pmi", "jfw", "umcc"]):
                return "rf_modules"
    
    # –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ RITTAL –≤—Å–µ–≥–¥–∞ –≤ "–î—Ä—É–≥–∏–µ"
    if has_any(text_blob, ["rittal"]):
        return "others"
    
    # –ù–∞–≥—Ä—É–∑–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–∞—è –≤ "–°–í–ß –º–æ–¥—É–ª–∏"
    if has_any(text_blob, ["–Ω–∞–≥—Ä—É–∑–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–∞—è", "—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞", "matched load"]):
        return "rf_modules"
    
    # –í–µ–Ω—Ç–∏–ª–∏ –°–í–ß/–í–ß –≤ "–°–í–ß –º–æ–¥—É–ª–∏" (circulator, isolator)
    if has_any(text_blob, ["–≤–µ–Ω—Ç–∏–ª—å —Å–≤—á", "–≤–µ–Ω—Ç–∏–ª—å –≤—á", "circulator", "isolator", "–ø—Ä–∏–±–æ—Ä —Ñ–≤–∫", "–ø—Ä–∏–±–æ—Ä —Ñ–∫–≤–Ω", "—Ñ–≤–∫3-", "—Ñ–∫–≤–Ω3-"]):
        return "rf_modules"
    
    # –í–µ–Ω—Ç–∏–ª–∏ —Å –∫–æ–¥–∞–º–∏ –ì–í–ê–¢ (–Ω–∞—à–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –°–í–ß) –≤ "–°–í–ß –º–æ–¥—É–ª–∏"
    if has_any(text_blob, ["–≤–µ–Ω—Ç–∏–ª—å"]) and has_any(text_blob, ["–≥–≤–∞—Ç"]):
        return "rf_modules"
    
    # Dev boards / evaluation boards / –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä—ã / –º–æ–¥—É–ª–∏ —Å–≤—è–∑–∏
    if has_any(text_blob, ["–ø–ª–∞—Ç–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è", "evaluation board", "dev board", "–æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –ø–ª–∞—Ç–∞", "–ø–ª–∞—Ç–∞ 117212",
                           "–∫–æ–º–º—É—Ç–∞—Ç–æ—Ä", "nt1", "–º–æ–¥—É–ª—å —Å–≤—è–∑–∏"]):
        if has_any(text_blob, ["qualwave", "api technologies", "weinschel", "hittite", "planet", "–∫–æ–º–º—É—Ç–∞—Ç–æ—Ä", 
                               "ebyte", "chengdu ebyte", "nt1"]):
            return "dev_boards"
    
    # –®–∏—Ä–æ–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–µ—Å–ª–∏ –Ω–µ –ø–æ–ø–∞–ª–∏ –≤—ã—à–µ)
    if has_any(text_blob, ["–æ–ø—Ç–∏—á", "optical"]):
        return "optics"
    
    # Optical modules with U prefix - check before "U" prefix for ICs
    if ref and ref_prefix.startswith("U"):
        if has_any(text_blob, ["–æ–ø—Ç–∏—á–µ—Å–∫–∏–π", "optical", "–ø–µ—Ä–µ–¥–∞—é—â–∏–π", "–ø—Ä–∏–µ–º–Ω—ã–π"]):
            return "optics"
    
    # ===================================================================
    # –ì–†–£–ü–üO–í–´–ï –ó–ê–ì–û–õ–û–í–ö–ò: –¢–∏–ø –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
    # –≠—Ç–æ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –í–´–®–ï —á–µ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É reference!
    # –ï—Å–ª–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ –±—ã–ª —è–≤–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ "–ú–∏–∫—Ä–æ—Å—Ö–µ–º—ã", —Ç–æ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã
    # –≤ —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –¥–æ–ª–∂–Ω—ã –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –º–∏–∫—Ä–æ—Å—Ö–µ–º—ã, –¥–∞–∂–µ –µ—Å–ª–∏
    # —É –Ω–∏—Ö –ø—Ä–µ—Ñ–∏–∫—Å D, V, –∏–ª–∏ –¥—Ä—É–≥–æ–π –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å.
    # ===================================================================
    group_type_text = to_text(group_type)
    if group_type_text:
        group_lower = group_type_text.lower()
        if '–º–∏–∫—Ä–æ—Å—Ö–µ–º' in group_lower:
            return "ics"
        elif '—Ä–µ–∑–∏—Å—Ç–æ—Ä' in group_lower:
            return "resistors"
        elif '–∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä' in group_lower:
            return "capacitors"
        elif '–¥—Ä–æ—Å—Å–µ–ª' in group_lower or '–∏–Ω–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç' in group_lower:
            return "inductors"
        elif '—Ä–∞–∑—ä–µ–º' in group_lower or '—Ä–∞–∑—å–µ–º' in group_lower:
            return "connectors"
        elif '–¥–∏–æ–¥' in group_lower and '—Å–≤–µ—Ç–æ–¥–∏–æ–¥' not in group_lower:
            return "semiconductors"
        elif '—Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä' in group_lower:
            return "semiconductors"
        elif '—Å—Ç–∞–±–∏–ª–∏—Ç—Ä–æ–Ω' in group_lower:
            return "semiconductors"
        elif '—Å–≤–µ—Ç–æ–¥–∏–æ–¥' in group_lower:
            return "semiconductors"
        elif '–∫–∞–±–µ–ª' in group_lower or '–ø—Ä–æ–≤–æ–¥' in group_lower:
            return "cables"
        elif '—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä' in group_lower:
            return "inductors"
    
    # PRIORITY 2: Heuristics by ref (only if we have a real ref column)
    if ref:
        if ref_prefix.startswith("R"):
            return "resistors"
        if ref_prefix.startswith("C"):
            return "capacitors"
        if ref_prefix.startswith("L"):
            return "inductors"
        # –†–æ—Å—Å–∏–π—Å–∫–∏–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –º–∏–∫—Ä–æ—Å—Ö–µ–º: DD, DA, D (—Ü–∏—Ñ—Ä–æ–≤—ã–µ –∏ –∞–Ω–∞–ª–æ–≥–æ–≤—ã–µ)
        # DD - —Ü–∏—Ñ—Ä–æ–≤—ã–µ –º–∏–∫—Ä–æ—Å—Ö–µ–º—ã, DA - –∞–Ω–∞–ª–æ–≥–æ–≤—ã–µ, D - —Ü–∏—Ñ—Ä–æ–≤—ã–µ (—Å—Ç–∞—Ä–æ–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ)
        # U - —Ç–∞–∫–∂–µ –º–∏–∫—Ä–æ—Å—Ö–µ–º—ã, –ù–û –ø—Ä–æ–≤–µ—Ä—è–µ–º –æ–ø—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏
        if ref_prefix.startswith("U"):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–ø—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏ (–ø–µ—Ä–µ–¥–∞—é—â–∏–µ, –ø—Ä–∏–µ–º–Ω—ã–µ)
            if has_any(text_blob, [
                "–æ–ø—Ç–∏—á–µ—Å–∫–∏–π –º–æ–¥—É–ª—å", "optical module", 
                "–ø–µ—Ä–µ–¥–∞—é—â–∏–π –æ–ø—Ç–∏—á–µ—Å–∫–∏–π", "–ø—Ä–∏–µ–º–Ω—ã–π –æ–ø—Ç–∏—á–µ—Å–∫–∏–π",
                "mp2320", "mp2220", "sfp", "qsfp"
            ]):
                return "optics"
            # –ò–Ω–∞—á–µ —ç—Ç–æ –º–∏–∫—Ä–æ—Å—Ö–µ–º–∞
            return "ics"
        if ref_prefix.startswith(("DD", "DA", "IC")):
            return "ics"
        # –ü—Ä–µ—Ñ–∏–∫—Å "D" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - –º–∏–∫—Ä–æ—Å—Ö–µ–º—ã (–≤ —Ä–æ—Å—Å–∏–π—Å–∫–æ–π –ø—Ä–∞–∫—Ç–∏–∫–µ)
        # –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: –µ—Å–ª–∏ —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–æ —á—Ç–æ —ç—Ç–æ –¥–∏–æ–¥, —Å—Ç–∞–±–∏–ª–∏—Ç—Ä–æ–Ω –∏ —Ç.–¥.
        if ref_prefix.startswith("D") and not ref_prefix.startswith(("DD", "DA")):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —è–≤–Ω–æ –¥–∏–æ–¥–æ–º/—Å—Ç–∞–±–∏–ª–∏—Ç—Ä–æ–Ω–æ–º
            if has_any(text_blob, ["–¥–∏–æ–¥", "diode", "—Å—Ç–∞–±–∏–ª–∏—Ç—Ä–æ–Ω", "zener", "–≤—ã–ø—Ä—è–º–∏—Ç–µ–ª", "—Å–≤–µ—Ç–æ–¥–∏–æ–¥", "led"]):
                return "semiconductors"
            # –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–¥ –¢–£ —Å —Ç–∏–ø–∏—á–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –º–∏–∫—Ä–æ—Å—Ö–µ–º—ã –∏–ª–∏ —è–≤–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–∏–∫—Ä–æ—Å—Ö–µ–º—ã - —ç—Ç–æ –º–∏–∫—Ä–æ—Å—Ö–µ–º–∞
            if has_any(text_blob, ["—Ç—É", "tu", "–∞–µ—è—Ä", "–∞–µ–Ω–≤", "–∞–ª—è—Ä", "sn74", "ad9", "lmk", "hmc", "ti", "texas instruments", "analog devices"]):
                return "ics"
            # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é D* —Å—á–∏—Ç–∞–µ–º –º–∏–∫—Ä–æ—Å—Ö–µ–º–æ–π
            return "ics"
        if ref_prefix.startswith(("J", "P", "K", "XT", "XS", "XP", "XW", "JTAG")):
            return "connectors"
        # Prefix "X" - –Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑—ä–µ–º –∏–ª–∏ –¥—Ä—É–≥–æ–µ)
        if ref_prefix.startswith("X"):
            # –ï—Å–ª–∏ —ç—Ç–æ —Ä–∞–∑—ä–µ–º, –∞–¥–∞–ø—Ç–µ—Ä - –≤ connectors
            if has_any(text_blob, ["—Ä–∞–∑—ä–µ–º", "connector", "–∞–¥–∞–ø—Ç–µ—Ä", "adapter", "–≤–∏–ª–∫–∞", "—Ä–æ–∑–µ—Ç–∫–∞", "jack", "plug", "socket"]):
                return "connectors"
            # –ò–Ω–∞—á–µ —Ç–æ–∂–µ –≤ connectors (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è X)
            return "connectors"
        # Prefix "G" for generators
        if ref_prefix.startswith("G"):
            # –ï—Å–ª–∏ —ç—Ç–æ –º–æ–¥—É–ª—å –ø–∏—Ç–∞–Ω–∏—è - –≤ power_modules
            if has_any(text_blob, ["–º–æ–¥—É–ª—å –ø–∏—Ç–∞–Ω–∏—è", "power module", "—à—Å–∫-–º"]):
                return "power_modules"
            # –ò–Ω–∞—á–µ –≤ others (–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã, –∫–≤–∞—Ä—Ü—ã –∏ —Ç.–¥.)
            return "others"
        # Prefix "F" or "FU" for fuses (–ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª–∏)
        if ref_prefix.startswith(("F", "FU")):
            return "others"
        # Prefix "A" or "–ê" (latin or cyrillic) - —É–º–Ω–∞—è –ª–æ–≥–∏–∫–∞
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ç–æ—á–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
        if ref_prefix.startswith(("A", "–ê")):
            # 1. –û–ø—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–ª–∏–Ω–∏–∏ –∑–∞–¥–µ—Ä–∂–∫–∏, –∫–∞–±–µ–ª–∏, –º–æ–¥—É–ª–∏)
            if has_any(text_blob, [
                "–º–≤–æ–ª–∑", "–ª–∏–Ω–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏", "–æ–ø—Ç–∏—á–µ—Å–∫–∏–π", "optical", 
                "fc/apc", "fc/upc", "sc/apc", "lc/apc",
                "–∫–∞–±–µ–ª—å —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –æ–ø—Ç–∏—á–µ—Å–∫–∏–π", "–ø–∞—Ç—á-–∫–æ—Ä–¥ –æ–ø—Ç–∏—á"
            ]):
                return "optics"
            # 2. –ù–∞—à–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–ø–ª–∞—Ç—ã —Å –Ω–∞—à–∏–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏ –∏–ª–∏ –ê–ú–§–ò/–ì–í–ê–¢)
            if has_any(text_blob, [
                "195-9530", "195-", "–≥–≤–∞—Ç", "–∞–º—Ñ–∏", 
                "–ø–ª–∞—Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞", "–ø–ª–∞—Ç–∞ —à—Å–∫", "—à—Å–∫-–º",
                "–Ω–∞—à–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞", "—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç"
            ]):
                return "our_developments"
            # 3. –ö–æ–º–º—É—Ç–∞—Ç–æ—Ä—ã –æ–ø—Ç–∏—á–µ—Å–∫–∏–µ
            if has_any(text_blob, ["–∫–æ–º–º—É—Ç–∞—Ç–æ—Ä", "–º–≤–æ–∫"]):
                return "optics"
            # 4. –ê—Ç—Ç–µ–Ω—é–∞—Ç–æ—Ä—ã (–æ–ø—Ç–∏—á–µ—Å–∫–∏–µ –∏–ª–∏ –°–í–ß)
            if has_any(text_blob, ["–∞—Ç—Ç–µ–Ω—é–∞—Ç", "–æ—Å–ª–∞–±–∏—Ç–µ–ª", "attenuator"]):
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ–ø—Ç–∏—á–µ—Å–∫–∏–π –ª–∏ —ç—Ç–æ –∞—Ç—Ç–µ–Ω—é–∞—Ç–æ—Ä
                if has_any(text_blob, ["–æ–ø—Ç–∏—á", "optical", "fc/apc", "fc/upc", "fiber"]):
                    return "optics"
                else:
                    # –°–í–ß/—ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∞—Ç—Ç–µ–Ω—é–∞—Ç–æ—Ä—ã -> –°–í–ß –º–æ–¥—É–ª–∏
                    return "rf_modules"
            # 5. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è A* –±–µ–∑ —è–≤–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚Üí dev_boards
            return "dev_boards"
        # Prefix "WS" and "WU" - specific RF module prefixes (check BEFORE "W")
        if ref_prefix.startswith("WS"):
            return "rf_modules"
        if ref_prefix.startswith("WU"):
            return "rf_modules"
        # Prefix "W" often used for RF modules (check AFTER WS/WU)
        if ref_prefix.startswith("W"):
            # –í—Å–µ–≥–¥–∞ –≤ rf_modules –¥–ª—è W-–ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ (–∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä—ã, —É—Å–∏–ª–∏—Ç–µ–ª–∏, –≤–µ–Ω—Ç–∏–ª–∏, –∞—Ç—Ç–µ–Ω—é–∞—Ç–æ—Ä—ã –∏ —Ç.–¥.)
            # –¢–∏–ø–∏—á–Ω—ã–µ –°–í–ß –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º W
            if has_any(text_blob, [
                "—Å–≤—á", "–≤—á", "rf", "–≤–µ–Ω—Ç–∏–ª—å", "circulator", "isolator",
                "–ª–∏–Ω–∏—è –∑–∞–¥–µ—Ä–∂–µ–∫", "delay line", "—É—Å–∏–ª–∏—Ç–µ–ª—å", "amplifier", "lna",
                "–¥–µ–ª–∏—Ç–µ–ª—å", "—Å—É–º–º–∞—Ç–æ—Ä", "splitter", "combiner", "divider",
                "–∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä –∞—á—Ö", "equalizer", "–∞—Ç—Ç–µ–Ω—é–∞—Ç", "attenuator",
                "—Ñ–∞–∑–æ–≤—Ä–∞—â–∞—Ç–µ–ª—å", "phase shifter", "–¥–µ—Ç–µ–∫—Ç–æ—Ä", "detector",
                "–æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å", "limiter", "—Å–º–µ—Å–∏—Ç–µ–ª—å", "mixer"
            ]):
                return "rf_modules"
            # –ï—Å–ª–∏ –Ω–µ—Ç —è–≤–Ω—ã—Ö –º–∞—Ä–∫–µ—Ä–æ–≤, –Ω–æ –ø—Ä–µ—Ñ–∏–∫—Å W - –≤—Å—ë —Ä–∞–≤–Ω–æ –≤ rf_modules (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
            return "rf_modules"
        # Prefix "H" for indicators/LEDs
        if ref_prefix.startswith("H"):
            return "semiconductors"
        # Prefix "VD" for diodes and zener diodes (Russian standard)
        if ref_prefix.startswith("VD"):
            return "semiconductors"
        # Prefix "V", "VT", "Q" for transistors
        if ref_prefix.startswith(("V", "VT", "Q")):
            if has_any(text_blob, ["–º–∏–∫—Ä–æ—Å—Ö–µ–º", "–º–∏–∫—Ä–æ—Å—Ö–µ–º–∞"]):
                return "ics"
            return "semiconductors"
        # Prefix "S" for switches/buttons/optical switches
        if ref_prefix.startswith("S"):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –æ–ø—Ç–∏—á–µ—Å–∫–∏–π –ª–∏ —ç—Ç–æ –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä
            if has_any(text_blob, ["–∫–æ–º–º—É—Ç–∞—Ç–æ—Ä", "–º–≤–æ–∫", "optical switch"]):
                return "optics"
            # –û–±—ã—á–Ω—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏, –∫–Ω–æ–ø–∫–∏
            if has_any(text_blob, ["–ø–µ—Ä–µ–∫–ª—é—á", "—Ç—É–º–±–ª–µ—Ä", "–∫–Ω–æ–ø–∫–∞", "switch", "button", "toggle"]):
                return "others"

    # Russian and English keywords
    if RESISTOR_VALUE_RE.search(text_blob) or has_any(text_blob, ["—Ä–µ–∑–∏—Å—Ç", "resistor"]):
        return "resistors"

    if CAP_VALUE_RE.search(text_blob) or has_any(text_blob, ["–∫–æ–Ω–¥–µ–Ω—Å", "capacitor", "tantalum", "ceramic", "–∫10-", "–∫53-"]):
        # –ò—Å–∫–ª—é—á–∞–µ–º –¥–µ–ª–∏—Ç–µ–ª–∏ –º–æ—â–Ω–æ—Å—Ç–∏ (–º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–æ–º–∏–Ω–∞–ª—ã, –ø–æ—Ö–æ–∂–∏–µ –Ω–∞ –µ–º–∫–æ—Å—Ç—å)
        if not has_any(text_blob, ["–¥–µ–ª–∏—Ç–µ–ª—å –º–æ—â–Ω–æ—Å—Ç–∏", "–¥–µ–ª–∏—Ç–µ–ª—å  –º–æ—â–Ω–æ—Å—Ç–∏", "power divider"]):
            return "capacitors"

    if IND_VALUE_RE.search(text_blob) or has_any(text_blob, ["–¥—Ä–æ—Å—Å", "–∏–Ω–¥—É–∫—Ç", "inductor", "ferrite", "—Ñ–µ—Ä—Ä–∏—Ç", "–∫–∞—Ç—É—à–∫–∞", "choke"]):
        return "inductors"
    
    # –ü—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª–∏ - check BEFORE semiconductors and ICs
    if has_any(text_blob, ["–ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å", "fuse", "fuzetec"]):
        return "others"
    
    # Semiconductors (–¥–∏–æ–¥—ã, —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä—ã, —Å—Ç–∞–±–∏–ª–∏—Ç—Ä–æ–Ω—ã, –æ–ø—Ç—Ä–æ–Ω—ã) - check BEFORE ICs
    if has_any(text_blob, [
        "–¥–∏–æ–¥", "—Å—Ç–∞–±–∏–ª–∏—Ç—Ä–æ–Ω", "—Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä", "–æ–ø—Ç—Ä–æ–Ω", "–æ–ø—Ç–æ–ø–∞—Ä", "2—Å630", "2—Ç630", "–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä", 
        "led ", "svetodiod", "indicator", "transistor", "optocoupler", "thyristor", "—Ç–∏—Ä–∏—Å—Ç–æ—Ä",
        "mosfet", "igbt", "triac", "—Å–∏–º–∏—Å—Ç–æ—Ä", "–ø–æ–ª–µ–≤–æ–π —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä", "–±–∏–ø–æ–ª—è—Ä–Ω—ã–π —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä"
    ]):
        return "semiconductors"

    if has_any(text_blob, [
        "–º–∏–∫—Ä–æ—Å—Ö–µ–º", " ic", "mcu", "–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä", "–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä", "–æ–ø-–∞–º–ø", "op-amp", "opamp", "adc", "dac", "fpga",
        "asic", "–¥—Ä–∞–π–≤–µ—Ä ", "–∫–æ–º–ø–∞—Ä–∞—Ç–æ—Ä", "—Å—Ç–∞–±–∏–ª", "—Ä–µ–≥—É–ª—è—Ç–æ—Ä", "transceiver", "sn74", "ti ", "stm32", "lmk", "ad9"
    ]):
        return "ics"

    if has_any(text_blob, [
        "—Ä–∞–∑—ä–µ–º", "—Ä–∞–∑—ä—ë–º", "connector", "header", "socket", "rj45", "rj11", "sma", "bnc", "terminal", "–∫–ª–µ–º–º",
        "—à—Ç—ã—Ä—å", "pin header", "fpc", "ffc", "din", "dc jack", "barrel", "—à—Ç–µ–∫–µ—Ä", "–≤–∏–ª–∫–∞", "—Ä–æ–∑–µ—Ç–∫–∞", "d-sub", "harting"
    ]):
        return "connectors"

    if has_any(text_blob, [
        "–æ—Ç–ª–∞–¥–æ—á", " dev board", "evaluation", "eval", "nucleo", "arduino", "raspberry",
        "esp32", "stm32 nucleo", "breakout", "fmc", "carrier", "ultrazed", "microzed", "picozed", "zedboard",
        "zynq", "som ", "system on module", "voyager", "tinypilot", "–ø–ª–∞—Ç–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è", "evaluation board",
        "development board", "–æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –ø–ª–∞—Ç–∞", "aes-zu"
    ]):
        return "dev_boards"

    # New categories
    if has_any(text_blob, [
        "–æ–ø—Ç–∏—á–µ—Å", "–ª–∞–∑–µ—Ä", "–æ–ø—Ç–æ–ø–∞—Ä–∞", "led ", "—Å–≤–µ—Ç–æ–¥–∏–æ–¥", "fiber", "–æ–ø—Ç–æ–≤–æ–ª–æ–∫", "sfp", "qsfp", "transceiver module",
        "–∞—Ç—Ç–µ–Ω—é–∞—Ç", "–æ—Å–ª–∞–±–∏—Ç–µ–ª", "fc/apc", "fc/upc", "sc/apc", "lc/apc", "pigtail", "–ø–∞—Ç—á-–∫–æ—Ä–¥ –æ–ø—Ç–∏—á"
    ]):
        return "optics"

    if has_any(text_blob, [
        "—Å–≤—á", "–≤—á ", "rf ", "microwave", "mini-circuits", "planar monolithics", "pmi", "ghz", "lna", "rf amp",
        "–ª–∏–Ω–∏—è –∑–∞–¥–µ—Ä–∂–µ–∫", "delay line", "–¥–µ–ª–∏—Ç–µ–ª—å –º–æ—â–Ω–æ—Å—Ç–∏", "—Å—É–º–º–∞—Ç–æ—Ä", "splitter", "combiner", "—É—Å–∏–ª–∏—Ç–µ–ª",
        "polaris", "gigabaudics", "etl systems", "vat-", "zx60", "pne-l", "–æ—Ç–≤–µ—Ç–≤–∏—Ç–µ–ª—å", "coupler", "—Ñ–∞–∑–æ–≤—Ä–∞—â–∞—Ç–µ–ª—å",
        "phase shifter", "–¥–µ—Ç–µ–∫—Ç–æ—Ä", "detector", "–æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å", "limiter", "–∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä –∞—á—Ö", "equalizer", "qpd", "power divider"
    ]):
        # –ù–û! –ù–µ Qualwave –∞—Ç—Ç–µ–Ω—é–∞—Ç–æ—Ä—ã QFA
        if has_any(text_blob, ["–∞—Ç—Ç–µ–Ω—é–∞—Ç–æ—Ä qfa", "qfa"]) and not has_any(text_blob, ["qpd"]):
            return "others"
        return "rf_modules"

    if has_any(text_blob, [
        "–∫–∞–±–µ–ª—å", "cable", "—à–ª–µ–π—Ñ", "–ø—Ä–æ–≤–æ–¥", "wire", "patch cord", "–ø–∞—Ç—á-–∫–æ—Ä–¥", "–ø–∞—Ç—á –∫–æ—Ä–¥", 
        "jumper", "–∫–∞–±–µ–ª—å–Ω", "—Å–±–æ—Ä–∫–∞ –∫–∞–±–µ–ª—å–Ω–∞—è"
    ]):
        return "cables"

    if has_any(text_blob, [
        "–º–æ–¥—É–ª—å –ø–∏—Ç–∞–Ω–∏—è", "power module", "dc-dc", "ac-dc", "buck", "boost", "–∏—Å—Ç–æ—á–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è", "–±–ª–æ–∫ –ø–∏—Ç–∞–Ω–∏—è", "psu",
        "converter", "—ç–ª–µ–∫—Ç—Ä–æ–ø–∏—Ç–∞–Ω–∏—è", "–º–¥–º10", "–º–¥–º20", "–º–¥–º30", "–º–¥–º50", "–º–¥–º60", "–º–¥–º100", "–º–¥–º160", "–º–¥–º600",
        "–º–∞–∞20", "–º–∞–∞400", "–º–∞–∞600"
    ]):
        return "power_modules"

    # OTHER general hardware to bucket into 'others'
    if has_any(text_blob, [
        "rittal", "—à–∫–∞—Ñ", "—Å—Ç–∞–Ω—Ü–∏—è", "–ø–æ–ª–∫–∞", "–∫—Ä–æ–Ω—à—Ç–µ–π–Ω", "—Ä–æ–ª–∏–∫", "–±–æ–ª—Ç", "–≥–∞–π–∫–∞", "—à–∞–π–±–∞", "–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞", "–º–æ–Ω–æ–±–ª–æ–∫",
        "–∫–∞–±–µ–ª—å", "–∫–ª–µ–º–º–Ω–∞—è", "–∫–æ—Ä–ø—É—Å", "—à–∞—Å—Å–∏", "—Å—Ç–µ–ª–ª–∞–∂", "—Å—Ç–æ–π–∫–∞", "–ø—Ä–æ–≤–æ–¥", "—Ä–æ–∑–µ—Ç–∫–∞", "–≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä", "–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä",
        "–ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å", "–¥–µ—Ä–∂–∞—Ç–µ–ª", "–∑–∞–∂–∏–º", "fuzetec", "—Ä–µ–ª–µ", "relay", "—Ç—É–º–±–ª–µ—Ä", "—Ñ–∏–ª—å—Ç—Ä", "filter",
        "—Å–µ—Ç–∫–∞ –∑–∞—â–∏—Ç–Ω–∞—è", "–∫–æ–º–º—É—Ç–∞—Ç–æ—Ä", "switch", "–ø–µ—Ä–µ—Ö–æ–¥", "adapter", "–ª–∏–Ω–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏", "delay line",
        "–∫–≤–∞—Ä—Ü", "quartz", "–≤—Å—Ç–∞–≤–∫–∞ –ø–ª–∞–≤–∫–∞—è"
    ]):
        return "others"

    # In strict mode, avoid loose matches
    return "unclassified"
