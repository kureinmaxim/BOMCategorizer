# Восстановление установки BOM Categorizer

Если после установки приложение не запускается и показывает ошибку "ModuleNotFoundError: No module named 'pandas'", это означает, что зависимости не были установлены корректно.

**ВАЖНО:** Все скрипты восстановления работают **БЕЗ ПОДКЛЮЧЕНИЯ К ИНТЕРНЕТУ** - все необходимые пакеты уже включены в инсталлятор!

## Проблема

В файле `debug_log.txt` вы увидите примерно такую ошибку:

```
===== VENV PACKAGE LIST ===== 
Package Version
------- -------
pip     24.3.1

===== END OF PACKAGE LIST ===== 

Traceback (most recent call last):
  File "C:\Users\...\AppData\Roaming\BOMCategorizer\app.py", line 24, in <module>
    from bom_categorizer.gui import BOMCategorizerApp
  ...
ModuleNotFoundError: No module named 'pandas'
```

Это означает, что установлен только `pip`, но не установлены необходимые пакеты.

## Решение

### Способ 1: Автоматическое восстановление (рекомендуется)

1. Откройте директорию установки:
   - По умолчанию: `C:\Users\ВашеИмя\AppData\Roaming\BOMCategorizer`
   - Или через меню "Пуск" → найдите ярлык "BOM Categorizer" → ПКМ → "Открыть расположение файла"

2. Найдите и запустите файл `repair_install.bat`

3. Дождитесь завершения установки пакетов

4. Запустите приложение снова через ярлык в меню "Пуск"

### Способ 2: Ручная установка через PowerShell

1. Откройте PowerShell от имени администратора

2. Перейдите в директорию установки:
   ```powershell
   cd "$env:APPDATA\BOMCategorizer"
   ```

3. Запустите скрипт восстановления:
   ```powershell
   powershell.exe -ExecutionPolicy Bypass -File repair_install.ps1
   ```

4. Проверьте, что все пакеты установлены:
   ```powershell
   .\.venv\Scripts\python.exe -m pip list
   ```

   Вы должны увидеть список, включающий:
   - pandas
   - openpyxl
   - python-docx
   - и другие зависимости

### Способ 3: Переустановка

Если восстановление не помогло:

1. Удалите приложение через "Панель управления" → "Программы и компоненты"

2. Удалите папку `C:\Users\ВашеИмя\AppData\Roaming\BOMCategorizer` вручную, если она осталась

3. Установите приложение заново, используя `BOMCategorizerSetup.exe`

## Проверка успешной установки

После восстановления откройте файл `debug_log.txt` в директории установки. В нем должен быть список пакетов:

```
===== VENV PACKAGE LIST ===== 
Package         Version
--------------- -------
et-xmlfile      2.0.0
lxml            6.0.2
numpy           2.3.3
openpyxl        3.1.5
pandas          2.3.3
pip             24.3.1
python-dateutil 2.9.0.post0
python-docx     1.2.0
...
```

Если вы видите все эти пакеты, установка прошла успешно!

## Логи

Для диагностики проблем проверьте следующие файлы в директории установки:

- `debug_log.txt` - лог запуска приложения
- `install_log.txt` - лог первоначальной установки
- `repair_log.txt` - лог восстановления (если вы запускали repair_install)

## Требования

Убедитесь, что на компьютере установлен Python 3.9 или новее:

```cmd
python --version
```

Если Python не установлен, скачайте его с [python.org](https://www.python.org/downloads/) и установите, **обязательно отметив галочку "Add Python to PATH"**.

## Поддержка

Если проблема не решена, отправьте файлы логов (`debug_log.txt`, `install_log.txt`, `repair_log.txt`) разработчику для анализа.

---

## Что нового в версии 2.0.33

### Исправлено в этой версии:

1. **Парсинг многострочных элементов** 
   - Элементы из двух строк DOC таблицы теперь правильно объединяются
   
2. **Извлечение PAT/РАТ элементов**
   - Расширена база данных компонентов
   - База включена в инсталлятор
   - Автоматическое слияние при обновлении

3. **Подборные номиналы резисторов**
   - "6,8Ом" → "6.8 Ом" (правильное преобразование)
   
4. **Подборные конденсаторы**
   - Устранены ложные срабатывания (GRM1555C1H100G)
   - Артикулы извлекаются корректно

5. **Улучшена диагностика установки**
   - Подробные логи
   - Скрипты восстановления
   - Пошаговые инструкции

---

**Версия:** 2.0.33  
**Дата:** 31.10.2025  
**Статус:** ✅ Актуально

