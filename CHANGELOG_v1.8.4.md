# –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–µ—Ä—Å–∏–∏ 1.8.4 (09.10.2025)

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. ‚≠ê –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ BOM

**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–∫–ª—é—á–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ BOM –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–∫–∞–∑–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–º–µ–Ω—å—à–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–ª–∏ —É–¥–∞–ª–∏—Ç –ø–æ–∑–∏—Ü–∏–∏.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ GUI:**
1. –í –≥–ª–∞–≤–Ω–æ–º –æ–∫–Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Å–µ–∫—Ü–∏—è "–ò—Å–∫–ª—é—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ BOM"
2. –§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞ (–ø–æ—Å—Ç—Ä–æ—á–Ω–æ): `–ù–∞–∑–≤–∞–Ω–∏–µ –ò–í–ü, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ`
3. –ü—Ä–∏–º–µ—Ä—ã:
   ```
   AD9221AR, 2
   GRM1885C1H681J, 1
   SN74LVC8T245DWR, 3
   ```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ CLI:**
```bash
split_bom --inputs input.xlsx --xlsx output.xlsx --exclude-items exclude.txt
```

**–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ exclude.txt:**
```
AD9221AR, 2
GRM1885C1H681J MURATA, 1
# –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #
SN74LVC8T245DWR, 3
```

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
- –ï—Å–ª–∏ –≤ BOM —ç–ª–µ–º–µ–Ω—Ç —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º **4**, –∞ —É–∫–∞–∑–∞–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å **1**, —Ç–æ –≤ –≤—ã—Ö–æ–¥–µ –±—É–¥–µ—Ç **3**
- –ï—Å–ª–∏ –≤ BOM —ç–ª–µ–º–µ–Ω—Ç —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º **2**, –∞ —É–∫–∞–∑–∞–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å **3**, —Ç–æ —ç–ª–µ–º–µ–Ω—Ç –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω (–∏—Å–∫–ª—é—á–µ–Ω–æ 2), –∏ –±—É–¥–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± –æ—Å—Ç–∞—Ç–∫–µ
- –ü–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ —á–∞—Å—Ç–∏—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é –Ω–∞–∑–≤–∞–Ω–∏—è (case-insensitive)
- –≠–ª–µ–º–µ–Ω—Ç—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–º –∏—â—É—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "AD9221AR" –Ω–∞–π–¥–µ—Ç "AD9221AR Analog Devices")

**–í—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å:**
```
üîß –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∏–∑ —Ñ–∞–π–ª–∞: exclude.txt
–ù–∞–π–¥–µ–Ω–æ 3 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è
‚úì –£–º–µ–Ω—å—à–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ 'AD9221AR': 4 ‚Üí 2
‚úì –ò—Å–∫–ª—é—á–µ–Ω —ç–ª–µ–º–µ–Ω—Ç 'GRM1885C1H681J' (qty: 1)
‚úì –£–º–µ–Ω—å—à–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ 'SN74LVC8T245DWR': 5 ‚Üí 2

üìä –ò—Ç–æ–≥–æ –∏—Å–∫–ª—é—á–µ–Ω–æ: 1 —Å—Ç—Ä–æ–∫, —É–º–µ–Ω—å—à–µ–Ω–æ: 2 —Å—Ç—Ä–æ–∫
```

### 2. üîß –£–ª—É—á—à–µ–Ω–∏—è GUI

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≥–ª–∞–≤–Ω–æ–º –æ–∫–Ω–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Å–µ–∫—Ü–∏—è –ø–µ—Ä–µ–¥ –ª–æ–≥–∞–º–∏ –¥–ª—è –≤–≤–æ–¥–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- –ß–µ—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ñ–æ—Ä–º–∞—Ç—É –≤–≤–æ–¥–∞
- –°–µ–∫—Ü–∏—è –æ—Ç–¥–µ–ª–µ–Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–µ–π –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Å –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ

**–ü–æ—Ä—è–¥–æ–∫ —Å–µ–∫—Ü–∏–π –≤ GUI:**
1. –í—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
3. –ü–µ—Ä–µ–Ω–æ—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ "–ù–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–æ"
4. **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ BOM** ‚Üê –Ω–æ–≤–∞—è —Å–µ–∫—Ü–∏—è
5. –õ–æ–≥–∏

---

## üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

1. **`config.json`**
   - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è: 1.8.3 ‚Üí 1.8.4
   - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–∞—Ç–∞: 2025-10-09

2. **`bom_categorizer/__init__.py`**
   - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è: 1.7.5 ‚Üí 1.8.4

3. **`bom_categorizer/gui.py`**
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `self.exclude_items_text` –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è GUI —Å Text widget –¥–ª—è –≤–≤–æ–¥–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
   - ‚úÖ –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω `_build_args()`: —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Å –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏ –∏ –ø–µ—Ä–µ–¥–∞—á–∞ –≤ CLI

4. **`bom_categorizer/main.py`**
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∞—Ä–≥—É–º–µ–Ω—Ç `--exclude-items` –≤ argparse
   - ‚úÖ –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `parse_exclude_items(exclude_file_path)`: –ø–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
   - ‚úÖ –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `apply_exclusions(df, exclude_items, desc_col)`: –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∫ DataFrame
   - ‚úÖ –í—ã–∑–æ–≤ `apply_exclusions` –ø–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–ª–æ–Ω–æ–∫, –ø–µ—Ä–µ–¥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

### –ê–ª–≥–æ—Ä–∏—Ç–º apply_exclusions():

```
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Å–ø–∏—Å–∫–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π:
  1. –ù–∞–π—Ç–∏ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Å —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º (case-insensitive, partial match)
  2. –î–ª—è –∫–∞–∂–¥–æ–π –Ω–∞–π–¥–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:
     a. –ï—Å–ª–∏ —Ç–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ ‚â§ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è:
        - –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É –ø–æ–ª–Ω–æ—Å—Ç—å—é
        - –£–º–µ–Ω—å—à–∏—Ç—å –æ—Å—Ç–∞—Ç–æ–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è
     b. –ï—Å–ª–∏ —Ç–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ > –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è:
        - –£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ —Å—Ç—Ä–æ–∫–µ
        - –û—Å—Ç–∞—Ç–æ–∫ = 0 (–≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–æ)
  3. –ï—Å–ª–∏ –æ—Å—Ç–∞—Ç–æ–∫ > 0: –≤—ã–≤–µ—Å—Ç–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
```

### –ü–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ main():

```
1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (load_and_combine_inputs)
2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–ª–æ–Ω–æ–∫ (normalize_and_merge_columns)
3. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π (apply_exclusions)** ‚Üê –Ω–æ–≤—ã–π —à–∞–≥
4. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫
5. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
6. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª
7. –ó–∞–ø–∏—Å—å –≤ Excel
```

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: GUI

1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –î–æ–±–∞–≤–∏—Ç—å –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª
3. –í —Å–µ–∫—Ü–∏–∏ "–ò—Å–∫–ª—é—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ BOM" –≤–≤–µ—Å—Ç–∏:
   ```
   AD9221AR, 2
   GRM1885C1H681J, 1
   ```
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É
5. –í –ª–æ–≥–∞—Ö —É–≤–∏–¥–µ—Ç—å:
   ```
   ‚úì –£–º–µ–Ω—å—à–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ 'AD9221AR': 4 ‚Üí 2
   ‚úì –ò—Å–∫–ª—é—á–µ–Ω —ç–ª–µ–º–µ–Ω—Ç 'GRM1885C1H681J' (qty: 1)
   ```

### –ü—Ä–∏–º–µ—Ä 2: CLI

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `exclude.txt`:
```
AD9221AR, 2
SN74LVC8T245DWR, 1
```

–ó–∞–ø—É—Å—Ç–∏—Ç—å:
```bash
split_bom --inputs bom.xlsx --xlsx output.xlsx --exclude-items exclude.txt --combine
```

### –ü—Ä–∏–º–µ—Ä 3: –ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ

–í–≤–æ–¥ –≤ GUI:
```
AD9221, 1
```

–ù–∞–π–¥–µ—Ç –∏ –∏—Å–∫–ª—é—á–∏—Ç:
- `AD9221AR Analog Devices`
- `AD9221ARZ —Ñ.Analog Devices`
- `AD9221` (–ª—é–±—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã)

---

## üéâ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ì–∏–±–∫–æ—Å—Ç—å:** –ú–æ–∂–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å –ª—é–±—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å –ª—é–±—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º
2. **–£–¥–æ–±—Å—Ç–≤–æ:** –ü—Ä–æ—Å—Ç–æ–π —Ñ–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞ "–ù–∞–∑–≤–∞–Ω–∏–µ, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ"
3. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å:** –ü–æ–¥—Ä–æ–±–Ω—ã–π –ª–æ–≥ –æ–ø–µ—Ä–∞—Ü–∏–π –∏—Å–∫–ª—é—á–µ–Ω–∏—è
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
5. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –≤ GUI, —Ç–∞–∫ –∏ –≤ CLI

---

## üîß –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã  
‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä `--exclude-items` –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π  
‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –∏ –∫–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π  

---

*–í–µ—Ä—Å–∏—è: 1.8.4*  
*–î–∞—Ç–∞ —Ä–µ–ª–∏–∑–∞: 09.10.2025*  
*–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫: –ö—É—Ä–µ–∏–Ω –ú.–ù.*

